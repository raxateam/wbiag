<%@ include file="/system/wbheader.jsp"%> <%@ page import="javax.servlet.http.*" %> <%@ page import  = "com.workbrain.server.*"%> <%@ page import  = "com.workbrain.sql.*"%> <%@ page import  = "com.workbrain.server.jsp.*"%> <% 
//***************************************************************************************************************************
//
//PURPOSE:				Displays the header menu as well as the logged user info
//
//DEPENDENCIES:			None
//
//PARAMETERS: 			None
//
// ** NOTE **           Please be very careful about intruducing/removing carriage returns in <TD> and <a> tags. NS is very
//                      fussy about this stuff and will render the menu bar incorrectly.
//
//****************************************************************************************************************************
%> <!--Netscape Style--> <style type="text/css"> body { background-color : #0765B4; } </style> <wb:page type="VR" title="Workbrain - Navigation - Header" domain="workbrain_system" login="true" subsidiaryPage="true" > <%
DBConnection dbConn = JSPHelper.getConnection(request);
WebBrowserVersion browser = JSPHelper.getWebContext(request).getBrowserVersion();
boolean isNetscape =(browser.equals(WebBrowserVersion.NETSCAPE_4_0) || browser.equals(WebBrowserVersion.NETSCAPE_4_7));

%> <%if (!isNetscape) {%> <!--IE Style--> <style type="text/css"> body { background-color : #0765B4; margin:0px; padding:0px; } table.headerTabs td { white-space:nowrap;color:white; font-family:Verdana, Arial; font-color:white; text-align:center; font-weight:normal; background-color:#0061B0; cursor:hand; } .newMail { color:#33ffff; font-family:Verdana,Arial; font-size:8pt; font-weight:bold; text-decoration:none; } .loginName { color:white;font-size:10pt;font-family:Trebuchet MS;font-weight:bold; } </style> <%}%> <%if (isNetscape) {%> <Layer left=0 top=0> <style type="text/css"> table.headerTabs td { text-transform:uppercase; color:white; font-family:Verdana, Arial; text-align:center; font-weight:bold; background-color:#0061B0; cursor:hand; } table.headerTabs td a { color:white; text-decoration:none; } .loginName { color:white;font-size:10pt;font-family:Trebuchet MS;font-weight:bold; } .newMail { color:#33ffff; font-family:Verdana,Arial; font-size:8pt; font-weight:bold; } </style> <%}%> <wb:define id="contentFrame">frame2</wb:define> <wb:define id="headerNodeId">-1000002</wb:define> <wb:define id="folderDisplayJsp">folderTree.jsp</wb:define> <wb:define id="mfrmt_id"/> <wb:define id="mfrm_jsp"/> <wb:define id="mfrm_id"/> <wb:define id="userLang"/> <wb:sql createDataSource="sqlUserLanguage"> SELECT WBL_ID FROM WORKBRAIN_USER WHERE WBU_ID = <wb:getPageProperty id="userId"/> </wb:sql> <wb:dataSet id="dsUserLanguage" dataSource="sqlUserLanguage"> <wb:set id="userLang"><wb:getDataFieldValue name="WBL_ID"/></wb:set> </wb:dataSet> <wb:sql createDataSource="sqlHeaderItems"> SELECT VL_MAINTENANCE_FORM.MFRM_ID, VL_MAINTENANCE_FORM.MFRM_JSP, VL_MAINTENANCE_FORM.MFRM_LOC_NAME, VL_MAINTENANCE_FORM.MFRM_LOC_DESC, VL_MAINTENANCE_FORM.MFRMT_ID, VL_MAINTENANCE_FORM.MFRM_REDIRECT_URL, VL_MAINTENANCE_FORM.MFRM_MENUPARENT_ID, VL_MAINTENANCE_FORM.MFRM_PARENT_MFRM_ID FROM VL_MAINTENANCE_FORM, MAINTENANCE_FORM_GRP WHERE VL_MAINTENANCE_FORM.MFRM_MENUPARENT_ID = <wb:get id="headerNodeId"/> AND VL_MAINTENANCE_FORM.MFRM_ID = MAINTENANCE_FORM_GRP.MFRM_ID AND MAINTENANCE_FORM_GRP.WBG_ID = <wb:getPageProperty id="userGroupId"/> AND VL_MAINTENANCE_FORM.MFRMT_ID <> -2 ORDER BY VL_MAINTENANCE_FORM.MFRM_DISPLAY_SORT </wb:sql> <wb:define id='userName'><wb:getPageProperty id="userName" /></wb:define> <wb:define id="userFullNameString"> <td nowrap align=right> <table cellpadding=0 cellspacing=0 border=0><tr> <td align=right nowrap valign=middle> <img src="<%= request.getContextPath() %>/images/interface/arrowName.gif" width="17" height="13" alt="" border="0" hspace="4"> </td> <td nowrap valign=middle> <%if (isNetscape) {%> <span class="loginName"><wb:getPageProperty id="userFullName"/></span> <%} else {%> <span class="loginName" style="margin-right:6px;margin-top:3px"><wb:getPageProperty id="userFullName"/></span> <%}%> </td> </tr></table> </td> </wb:define> <table cellpadding=0 cellspacing=0 border=0 width=100% bgcolor="#0765B4"> <tr> <td> <table border=0 cellpadding=0 cellspacing=0 class='headerTabs'> <tr> <td> &nbsp; </td> <td>&nbsp;</td> <td width=15> <img src="<%= request.getContextPath() %>/images/interface/tabStart.gif" width="15" height="26" alt="" border="0"> </td> <wb:define id="rowNum">1</wb:define> <wb:dataSet id="dsHeaderItems" dataSource="sqlHeaderItems"> <td background="<%= request.getContextPath() %>/images/interface/gradTabBg.gif"><span class='linkLightMedium' style="font-size:8pt;"><b>&nbsp;</b></span></td> <wb:forEachRow> <wb:set id="mfrmt_id"><wb:getDataFieldValue name="mfrmt_id"/></wb:set> <wb:if expression="#rowNum > 1#"> <td nowrap valign=top><img src="<%= request.getContextPath() %>/images/interface/tabMid.gif" width="15" height="26" alt="" border="0"></td> </wb:if> <wb:switch> <wb:case expression="#mfrmt_id#" compareToExpression="8"> <%-- Folder type --%> <td nowrap background="<%= request.getContextPath() %>/images/interface/gradTabBg.gif"> <img src="<%= request.getContextPath() %>/images/pixel.gif" width="1" height="3" alt="" border="0"><br> <a target="contentFrame" href="<wb:get id="folderDisplayJsp"/>?rootId=<wb:getDataFieldValue name="mfrm_id"/>&expandLevel=1"> <span class='linkLightMedium' style="font-size:8pt;"><b><wb:encodeHTML><wb:getDataFieldValue name="mfrm_loc_name"/></wb:encodeHTML></b></span></a></td> </wb:case> <wb:case> <td nowrap background="<%= request.getContextPath() %>/images/interface/gradTabBg.gif"> <img src="<%= request.getContextPath() %>/images/pixel.gif" width="1" height="3" alt="" border="0"><br> <wb:set id="mfrm_jsp"><wb:getDataFieldValue name="mfrm_jsp"/></wb:set> <wb:set id="mfrm_id"><wb:getDataFieldValue name="mfrm_id"/></wb:set> <%                      StringBuffer maintLink = new StringBuffer("");
                            if (mfrm_jsp.toString().indexOf("mntForms.jsp") >= 0) {
                              maintLink.append("?mfrm_id=" + mfrm_id.toString());
                            }
    %> <a href="<%=mfrm_jsp.toString() + maintLink.toString()%>" target=_top style="text-decoration:none;" onClick="" title="<wb:getDataFieldValue name="MFRM_LOC_DESC"/>"> <span class='linkLightMedium' style="font-size:8pt;"><b><wb:getDataFieldValue name="mfrm_loc_name"/></b></span></a></td> </wb:case> </wb:switch> <wb:set id="rowNum"><wb:evaluate>rowNum + 1</wb:evaluate></wb:set> </wb:forEachRow> <wb:if expression="#rowNum > 1#"> <td valign=top><img src="<%= request.getContextPath() %>/images/interface/tabEnd.gif" width="15" height="26" alt="" border="0"></td> </wb:if> </tr> </table> </td> <wb:get id="userFullNameString"/> </tr> </table> </wb:dataSet> <%if (isNetscape) out.println("</Layer>");%> </wb:page> 